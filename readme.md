# 神经网络编程实践——基于CNN与Resnet的EMG信号分类

体育工程学院

2023.5.30

# 简介
此项目为神经网络设计与编程课程大作业。

# 文件描述
📦bighomework

 ┣ 📂configs  每次实验的配置文件

 ┣ 📂data 数据文件

 ┃ ┗ 📜EMG-data. 原始数据，复现中间文件需要执行完毕EMG.ipynb
 
 ┣ 📂doc  报告，ppt

 ┣ 📜EMG.ipynb  数据处理过程，可以直接查看，如需复现训练过程，需要依次执行

 ┣ 📜models.py   网络的基本定义

 ┣ 📜readme.md

 ┣ 📜requirements.txt   环境配置

 ┣ 📜train.py   训练脚本
  
 ┣ 📜utils.py  工具函数

 ┗ 📜view_model.py   将.pth模型转换程onnx模型以供netron可视化

 # install
```
pip install -r requirements.txt
```
注意，需要python==3.8，并且此配置为linux环境，最好在执行时候缺什么库安什么

# DataProces
在EMG.ipynb中依次执行代码块

# train
```
python train.py --config_file configs/{experiment.yaml}
```
请将{experiment.yaml}替换为configs文件夹下的配置文件名，即可复现对应实验

# ViewModel
这里使用netron作为可视化工具，需要提前安装
[Netron](https://github.com/lutzroeder/netron)

一旦安装了netron，可以执行以下命令将任意实验的模型进行可视化

```
python view_model.py --config_file configs/{experiment.yaml}
```

之后将生成的onnx文件通过netron打开即可进行可视化


# 其他
感谢老师一学期的教诲，收获颇丰！

## 为什么要用小波变换？
大三上有一门课叫 生理信号采集与分析 ，由张开宇老师主讲。其中提到了分析生理信号的数学工具小波变换

当时也正好接触到神经网络，人工智能。看到图片分类和时频图时就想到了能不能用小波变换脑电信号形成频谱图，再用CNN进行分类，以此控制机械臂（幻想时间）

之后也有实际查阅过一些论文，发现在脑机接口领域确实有这样的尝试。

随着深度学习技术的发展，像小波变换这样做特征工程的工具逐渐被人们所放下，人们更多的关注端到端的模型，让模型自己学习高维特征

但小波变换是否没有发展空间了？我觉得不是。我惊叹于其数学解释性，以及将频域分析和时域分析结合的能力。我相信这种可解释性是永远不会被替代的。最近火爆的kan网络也是出于其可解释性。

鉴于课程时间内容以及课程要求，这个想法一直没有加以实现。

这应该是本科阶段最后一个大作业了，不如试一试！

于是这次在神经网络设计与编程课程大作业中，终于有机会得以实现一直以来的脑洞（

虽然自己的网络模型很菜，但毕竟没有很长的时间进行设计和实验

生物医学工程与深度学习的结合，还有更广阔的知识需要学习

这次实践就当作一个小小的练习

希望以后的同学们有更多实践课时？这样才能真正学到本领的！

推荐以后可以将这两门课在一学期上，希望以后有学妹学弟能够实现用脑电信号控制机械臂！！（笑